{"remainingRequest":"D:\\vue_workspace\\jwsystem\\node_modules\\babel-loader\\lib\\index.js!D:\\vue_workspace\\jwsystem\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\vue_workspace\\jwsystem\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue_workspace\\jwsystem\\src\\views\\system\\role\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue_workspace\\jwsystem\\src\\views\\system\\role\\index.vue","mtime":1673700685924},{"path":"D:\\vue_workspace\\jwsystem\\babel.config.js","mtime":1666484881107},{"path":"D:\\vue_workspace\\jwsystem\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue_workspace\\jwsystem\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\vue_workspace\\jwsystem\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue_workspace\\jwsystem\\node_modules\\vue-loader\\lib\\index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnVuc2hpZnQuanMiOwppbXBvcnQgeyBsaXN0Um9sZSwgYWRkUm9sZSwgZ2V0Um9sZSwgdXBkYXRlUm9sZSwgZGVsZXRlUm9sZSwgdXBkYXRlUm9sZVN0YXR1cyB9IGZyb20gIi4uLy4uLy4uL2FwaS9zeXN0ZW0vcm9sZSI7CmltcG9ydCB7IHRyZWVzZWxlY3QgYXMgbWVudVRyZWVTZWxlY3QgfSBmcm9tICIuLi8uLi8uLi9hcGkvc3lzdGVtL21lbnUiOwppbXBvcnQgeyBnZXRQZXJtaXNzaW9uQnlSb2xlSWQgfSBmcm9tICIuLi8uLi8uLi9hcGkvc3lzdGVtL3JvbGVQZXJtaXNzaW9uIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJSb2xlIiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZGF0ZVJhbmdlOiBbXSwKICAgICAgcXVlcnlQYXJhbXM6IHsKICAgICAgICByb2xlTmFtZTogdW5kZWZpbmVkLAogICAgICAgIHJvbGVLZXk6IHVuZGVmaW5lZCwKICAgICAgICBzdGF0dXM6IHVuZGVmaW5lZCwKICAgICAgICBwYWdlTnVtOiAxLAogICAgICAgIHBhZ2VTaXplOiAxMAogICAgICB9LAogICAgICByb2xlTGlzdDogW10sCiAgICAgIHRvdGFsOiAwLAogICAgICB0aXRsZTogJycsCiAgICAgIG9wZW46IGZhbHNlLAogICAgICBmb3JtOiB7fSwKICAgICAgZGVmYXVsdFByb3BzOiB7CiAgICAgICAgY2hpbGRyZW46ICdjaGlsZHJlbicsCiAgICAgICAgbGFiZWw6ICduYW1lJwogICAgICB9LAogICAgICBydWxlczogewogICAgICAgIHJvbGVOYW1lOiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICBtZXNzYWdlOiAn6KeS6Imy5ZCN56ew5LiN6IO95Li656m6JywKICAgICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICAgIH1dLAogICAgICAgIHJvbGVLZXk6IFt7CiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgIG1lc3NhZ2U6ICfmnYPpmZDlrZfnrKbkuI3og73kuLrnqbonLAogICAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgICAgfV0sCiAgICAgICAgcm9sZVNvcnQ6IFt7CiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgIG1lc3NhZ2U6ICfop5LoibLpobrluo/kuI3og73kuLrnqbonLAogICAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgICAgfV0KICAgICAgfSwKICAgICAgbWVudU9wdGlvbnM6IFtdLAogICAgICBtZW51RXhwYW5kOiBmYWxzZSwKICAgICAgbWVudU5vZGVBbGw6IGZhbHNlLAogICAgICBtZW51Q2hlY2tTdHJpY3RseTogdHJ1ZSwKICAgICAgc2VsZWN0ZWRJZHM6IFtdLAogICAgICBzZWxlY3RlZE5hbWVzOiBbXSwKICAgICAgc2luZ2xlOiB0cnVlLAogICAgICBtdWx0aXBsZTogdHJ1ZSwKICAgICAgc2hvd1NlYXJjaDogdHJ1ZSwKICAgICAgY29sdW1uczogW3sKICAgICAgICBrZXk6IDAsCiAgICAgICAgbGFiZWw6ICfop5LoibLnvJblj7cnLAogICAgICAgIHZpc2libGU6IHRydWUKICAgICAgfSwgewogICAgICAgIGtleTogMSwKICAgICAgICBsYWJlbDogJ+inkuiJsuWQjeensCcsCiAgICAgICAgdmlzaWJsZTogdHJ1ZQogICAgICB9LCB7CiAgICAgICAga2V5OiAyLAogICAgICAgIGxhYmVsOiAn5p2D6ZmQ5a2X56ymJywKICAgICAgICB2aXNpYmxlOiB0cnVlCiAgICAgIH0sIHsKICAgICAgICBrZXk6IDMsCiAgICAgICAgbGFiZWw6ICfmmL7npLrpobrluo8nLAogICAgICAgIHZpc2libGU6IHRydWUKICAgICAgfSwgewogICAgICAgIGtleTogNCwKICAgICAgICBsYWJlbDogJ+eKtuaAgScsCiAgICAgICAgdmlzaWJsZTogdHJ1ZQogICAgICB9LCB7CiAgICAgICAga2V5OiA1LAogICAgICAgIGxhYmVsOiAn5Yib5bu65pe26Ze0JywKICAgICAgICB2aXNpYmxlOiB0cnVlCiAgICAgIH1dCiAgICB9OwogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0Um9sZUxpc3QoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGhhbmRsZVVwZGF0ZShyb3cpIHsKICAgICAgdGhpcy5yZXNldCgpOwogICAgICBsZXQgcm9sZUlkID0gcm93LmlkIHx8IHRoaXMuc2VsZWN0ZWRJZHM7CiAgICAgIC8vIOiOt+WPluaJgOacieeahOiPnOWNleWIl+ihqAogICAgICB0aGlzLmdldE1lbnVUcmVlU2VsZWN0KCk7CiAgICAgIGdldFJvbGUocm9sZUlkKS50aGVuKHJlcyA9PiB7CiAgICAgICAgdGhpcy4kc2V0KHRoaXMuZm9ybSwgJ3JvbGVJZCcsIHJlcy5pZCk7CiAgICAgICAgdGhpcy4kc2V0KHRoaXMuZm9ybSwgJ3JvbGVOYW1lJywgcmVzLm5hbWUpOwogICAgICAgIHRoaXMuJHNldCh0aGlzLmZvcm0sICdyb2xlS2V5JywgcmVzLmtleSk7CiAgICAgICAgdGhpcy4kc2V0KHRoaXMuZm9ybSwgJ3JvbGVTb3J0JywgcmVzLnNvcnQpOwogICAgICAgIHRoaXMuJHNldCh0aGlzLmZvcm0sICdyZW1hcmsnLCByZXMucmVtYXJrKTsKICAgICAgICB0aGlzLiRzZXQodGhpcy5mb3JtLCAnc3RhdHVzJywgTnVtYmVyKHJlcy5zdGF0dXMpKTsKICAgICAgICB0aGlzLm9wZW4gPSB0cnVlOwogICAgICAgIC8vIOiOt+WPluW9k+WJjeinkuiJsuW3suWIhumFjeeahOiPnOWNleWIl+ihqAogICAgICAgIGdldFBlcm1pc3Npb25CeVJvbGVJZChyb2xlSWQpLnRoZW4ocmVzdWx0ID0+IHsKICAgICAgICAgIGxldCBjaGVja2VkS2V5cyA9IHJlc3VsdDsKICAgICAgICAgIGNoZWNrZWRLZXlzLmZvckVhY2godiA9PiB7CiAgICAgICAgICAgIHRoaXMuJHJlZnMubWVudS5zZXRDaGVja2VkKHYsIHRydWUsIGZhbHNlKTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRSb2xlTGlzdCgpIHsKICAgICAgbGlzdFJvbGUodGhpcy5hZGREYXRlUmFuZ2UodGhpcy5xdWVyeVBhcmFtcywgdGhpcy5kYXRlUmFuZ2UpKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICB0aGlzLnJvbGVMaXN0ID0gcmVzcG9uc2UubGlzdDsKICAgICAgICB0aGlzLnRvdGFsID0gcmVzcG9uc2UudG90YWw7CiAgICAgIH0pOwogICAgfSwKICAgIGhhbmRsZVF1ZXJ5KCkgewogICAgICB0aGlzLnF1ZXJ5UGFyYW1zLnBhZ2VOdW0gPSAxOwogICAgICB0aGlzLmdldFJvbGVMaXN0KCk7CiAgICB9LAogICAgcmVzZXRRdWVyeSgpIHsKICAgICAgdGhpcy5kYXRlUmFuZ2UgPSBbXTsKICAgICAgdGhpcy5yZXNldEZvcm0oJ3F1ZXJ5Rm9ybScpOwogICAgICB0aGlzLmhhbmRsZVF1ZXJ5KCk7CiAgICB9LAogICAgaGFuZGxlQWRkKCkgewogICAgICB0aGlzLnJlc2V0KCk7CiAgICAgIHRoaXMuZ2V0TWVudVRyZWVTZWxlY3QoKTsKICAgICAgdGhpcy50aXRsZSA9ICfmt7vliqDop5LoibInOwogICAgICB0aGlzLm9wZW4gPSB0cnVlOwogICAgfSwKICAgIGhhbmRsZURlbGV0ZShyb3cpIHsKICAgICAgaWYgKHJvdyAhPSB1bmRlZmluZWQgJiYgcm93ICE9IG51bGwgJiYgcm93LmlkICE9IG51bGwpIHsKICAgICAgICB0aGlzLnNlbGVjdGVkSWRzLnB1c2gocm93LmlkKTsKICAgICAgfQogICAgICBsZXQgcm9sZUlkcyA9IHRoaXMuc2VsZWN0ZWRJZHM7CiAgICAgIHRoaXMuJG1vZGFsLmNvbmZpcm0oJ+ehruWumuWIoOmZpOinkuiJsuOAkCcgKyB0aGlzLnNlbGVjdGVkTmFtZXMuam9pbigpICsgJ+OAke+8nycpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIGRlbGV0ZVJvbGUocm9sZUlkcykudGhlbigoKSA9PiB7fSk7CiAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgIHRoaXMuJG1vZGFsLm1zZ1N1Y2Nlc3MoJ+WIoOmZpOaIkOWKnycpOwogICAgICAgIHRoaXMuc2VsZWN0ZWRJZHMgPSBbXTsKICAgICAgICB0aGlzLmdldFJvbGVMaXN0KCk7CiAgICAgIH0pOwogICAgfSwKICAgIGNhbmNlbCgpIHsKICAgICAgdGhpcy5yZXNldCgpOwogICAgICB0aGlzLm9wZW4gPSBmYWxzZTsKICAgIH0sCiAgICBzdWJtaXRGb3JtKCkgewogICAgICB0aGlzLiRyZWZzLmFkZFJvbGVGb3JtUmVmLnZhbGlkYXRlKHZhbGlkID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIGxldCBtZW51SWRzID0gdGhpcy5nZXRNZW51QWxsQ2hlY2tlZEtleXMoKTsKICAgICAgICAgIGlmIChtZW51SWRzICE9IG51bGwgJiYgbWVudUlkcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIHRoaXMuZm9ybS5wZXJtSWRzID0gbWVudUlkczsKICAgICAgICAgIH0KICAgICAgICAgIGlmICh0aGlzLmZvcm0ucm9sZUlkICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgdXBkYXRlUm9sZSh0aGlzLmZvcm0pLnRoZW4oKCkgPT4gewogICAgICAgICAgICAgIHRoaXMuJG1vZGFsLm1zZ1N1Y2Nlc3MoJ+S/ruaUueaIkOWKnycpOwogICAgICAgICAgICAgIHRoaXMuZ2V0Um9sZUxpc3QoKTsKICAgICAgICAgICAgICB0aGlzLm9wZW4gPSBmYWxzZTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBhZGRSb2xlKHRoaXMuZm9ybSkudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy4kbW9kYWwubXNnU3VjY2Vzcygn5paw5aKe5oiQ5YqfJyk7CiAgICAgICAgICAgICAgdGhpcy5nZXRSb2xlTGlzdCgpOwogICAgICAgICAgICAgIHRoaXMub3BlbiA9IGZhbHNlOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGdldE1lbnVBbGxDaGVja2VkS2V5cygpIHsKICAgICAgbGV0IGNoZWNrZWRLZXlzID0gdGhpcy4kcmVmcy5tZW51LmdldENoZWNrZWRLZXlzKCk7CiAgICAgIGxldCBoYWxmQ2hlY2tlZEtleXMgPSB0aGlzLiRyZWZzLm1lbnUuZ2V0SGFsZkNoZWNrZWRLZXlzKCk7CiAgICAgIGNoZWNrZWRLZXlzLnVuc2hpZnQuYXBwbHkoY2hlY2tlZEtleXMsIGhhbGZDaGVja2VkS2V5cyk7CiAgICAgIHJldHVybiBjaGVja2VkS2V5czsKICAgIH0sCiAgICByZXNldCgpIHsKICAgICAgdGhpcy5mb3JtID0gewogICAgICAgIHBlcm1JZHM6IFtdLAogICAgICAgIHN0YXR1czogMSwKICAgICAgICByb2xlU29ydDogMAogICAgICB9OwogICAgICB0aGlzLnJlc2V0Rm9ybSgnYWRkUm9sZUZvcm1SZWYnKTsKICAgIH0sCiAgICBnZXRNZW51VHJlZVNlbGVjdCgpIHsKICAgICAgbWVudVRyZWVTZWxlY3QoKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICB0aGlzLm1lbnVPcHRpb25zID0gcmVzcG9uc2U7CiAgICAgIH0pOwogICAgfSwKICAgIGhhbmRsZUNoZWNrZWRUcmVlRXhwYW5kKHZhbCwgdHlwZSkgewogICAgICBpZiAodHlwZSA9PT0gJ21lbnUnKSB7CiAgICAgICAgbGV0IHRyZWVMaXN0ID0gdGhpcy5tZW51T3B0aW9uczsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRyZWVMaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLm1lbnUuc3RvcmUubm9kZXNNYXBbdHJlZUxpc3RbaV0uaWRdLmV4cGFuZGVkID0gdmFsOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGhhbmRsZUNoZWNrZWRUcmVlTm9kZUFsbCh2YWwsIHR5cGUpIHsKICAgICAgaWYgKHR5cGUgPT09ICdtZW51JykgewogICAgICAgIHRoaXMuJHJlZnMubWVudS5zZXRDaGVja2VkTm9kZXModmFsID8gdGhpcy5tZW51T3B0aW9ucyA6IFtdKTsKICAgICAgfQogICAgfSwKICAgIGhhbmRsZUNoZWNrZWRUcmVlQ29ubmVjdCh2YWwsIHR5cGUpIHsKICAgICAgaWYgKHR5cGUgPT09ICdtZW51JykgewogICAgICAgIHRoaXMubWVudUNoZWNrU3RyaWN0bHkgPSB2YWw7CiAgICAgIH0KICAgIH0sCiAgICBoYW5kbGVTZWxlY3Rpb25DaGFuZ2UodmFsKSB7CiAgICAgIHRoaXMuc2VsZWN0ZWRJZHMgPSB2YWwubWFwKGl0ZW0gPT4gaXRlbS5pZCk7CiAgICAgIHRoaXMuc2VsZWN0ZWROYW1lcyA9IHZhbC5tYXAoaXRlbSA9PiBpdGVtLm5hbWUpOwogICAgICB0aGlzLnNpbmdsZSA9IHRoaXMuc2VsZWN0ZWRJZHMubGVuZ3RoICE9PSAxOwogICAgICB0aGlzLm11bHRpcGxlID0gIXRoaXMuc2VsZWN0ZWRJZHMubGVuZ3RoOwogICAgfSwKICAgIHVwZGF0ZVJvbGVTdGF0dXMocm93KSB7CiAgICAgIGxldCBkYXRhID0gewogICAgICAgICdyb2xlSWQnOiByb3cuaWQsCiAgICAgICAgJ3N0YXR1cyc6IHJvdy5zdGF0dXMKICAgICAgfTsKICAgICAgdXBkYXRlUm9sZVN0YXR1cyhkYXRhKS50aGVuKCgpID0+IHsKICAgICAgICB0aGlzLiRtb2RhbC5tc2dTdWNjZXNzKCfop5LoibLnirbmgIHkv67mlLnmiJDlip8nKTsKICAgICAgfSk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"mappings":";;AA8LA;AACA;AACA;AAGA;EACAA;EACAC;IACA;MACAC;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;QACAC;QACAC;MACA;MACAC;QACAb,WACA;UAAAc;UAAAC;UAAAC;QAAA,EACA;QACAf,UACA;UAAAa;UAAAC;UAAAC;QAAA,EACA;QACAC,WACA;UAAAH;UAAAC;UAAAC;QAAA;MAEA;MACAE;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC,UACA;QAAAC;QAAAhB;QAAAiB;MAAA,GACA;QAAAD;QAAAhB;QAAAiB;MAAA,GACA;QAAAD;QAAAhB;QAAAiB;MAAA,GACA;QAAAD;QAAAhB;QAAAiB;MAAA,GACA;QAAAD;QAAAhB;QAAAiB;MAAA,GACA;QAAAD;QAAAhB;QAAAiB;MAAA;IAEA;EACA;EACAC;IACA;EACA;EACAC;IACAC;MACA;MACA;MACA;MACA;MACAC;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACAC;UACA;UACAC;YACA;UACA;QACA;MACA;IACA;IACAC;MACAC;QACA;QACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;QACA;MACA;MACA;MACA;QACAC,gCAEA;MACA;QACA;QACA;QACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;QACA;UACA;UACA;YACA;UACA;UACA;YACAC;cACA;cACA;cACA;YACA;UACA;YACAC;cACA;cACA;cACA;YACA;UACA;QACA;MACA;IACA;IACAC;MACA;MACA;MACAZ;MACA;IACA;IACAa;MACA;QACAC;QACA/C;QACAe;MACA;MACA;IACA;IACAiC;MACAC;QACA;MACA;IACA;IACAC;MACA;QACA;QACA;UACA;QACA;MAEA;IACA;IACAC;MACA;QACA;MACA;IACA;IACAC;MACA;QACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;QACA;QACA;MACA;MACAA;QACA;MACA;IACA;EACA;AACA","names":["name","data","dateRange","queryParams","roleName","roleKey","status","pageNum","pageSize","roleList","total","title","open","form","defaultProps","children","label","rules","required","message","trigger","roleSort","menuOptions","menuExpand","menuNodeAll","menuCheckStrictly","selectedIds","selectedNames","single","multiple","showSearch","columns","key","visible","created","methods","handleUpdate","getRole","getPermissionByRoleId","checkedKeys","getRoleList","listRole","handleQuery","resetQuery","handleAdd","handleDelete","deleteRole","cancel","submitForm","updateRole","addRole","getMenuAllCheckedKeys","reset","permIds","getMenuTreeSelect","menuTreeSelect","handleCheckedTreeExpand","handleCheckedTreeNodeAll","handleCheckedTreeConnect","handleSelectionChange","updateRoleStatus"],"sourceRoot":"src/views/system/role","sources":["index.vue"],"sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n    <el-form :inline=\"true\" ref=\"queryForm\" :model=\"queryParams\" v-show=\"showSearch\">\r\n      <el-form-item label=\"角色名称\" prop=\"roleName\">\r\n        <el-input\r\n          v-model=\"queryParams.roleName\"\r\n          placeholder=\"请输入角色名称\"\r\n          size=\"small\"\r\n          style=\"width: 240px\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"权限字符\" prop=\"roleKey\">\r\n        <el-input\r\n          v-model=\"queryParams.roleKey\"\r\n          placeholder=\"请输入权限字符\"\r\n          size=\"small\"\r\n          style=\"width: 240px\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"状态\" prop=\"status\">\r\n        <el-select\r\n          v-model=\"queryParams.status\"\r\n          size=\"small\"\r\n          style=\"width: 240px\"></el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"创建时间\">\r\n        <el-date-picker\r\n          v-model=\"dateRange\"\r\n          type=\"daterange\"\r\n          range-separator=\"-\"\r\n          value-format=\"yyyy-MM-dd\"\r\n          start-placeholder=\"开始时间\"\r\n          end-placeholder=\"结束时间\"\r\n          size=\"small\"\r\n          style=\"width: 240px\"></el-date-picker>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button \r\n          type=\"primary\" \r\n          size=\"mini\" \r\n          icon=\"el-icon-search\"\r\n          @click=\"handleQuery\">搜索</el-button>\r\n        <el-button \r\n          icon=\"el-icon-refresh\"\r\n          size=\"mini\"\r\n          @click=\"resetQuery\">重置</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n    <el-row :gutter=\"10\">\r\n      <el-col :span=\"1.5\">\r\n        <el-button \r\n          type=\"primary\" \r\n          size=\"mini\" \r\n          icon=\"el-icon-plus\"\r\n          plain\r\n          v-hasPerm=\"['system:role:add']\"\r\n          @click=\"handleAdd\">新增</el-button>\r\n      </el-col>\r\n      <!--\r\n      <el-col :span=\"1.5\">\r\n        <el-button \r\n          type=\"success\" \r\n          size=\"mini\" \r\n          :disabled=\"single\"\r\n          icon=\"el-icon-edit\"\r\n          v-hasPerm=\"['system:role:edit']\"\r\n          @click=\"handleUpdate\"\r\n          plain>修改</el-button>\r\n      </el-col>\r\n      -->\r\n      <el-col :span=\"1.5\">\r\n        <el-button \r\n          type=\"danger\" \r\n          size=\"mini\"\r\n          :disabled=\"multiple\" \r\n          @click=\"handleDelete\"\r\n          icon=\"el-icon-delete\"\r\n          v-hasPerm=\"['system:role:delete']\"\r\n          plain>删除</el-button>\r\n      </el-col>\r\n      <right-toolbar :show-search.sync=\"showSearch\" @refresh=\"getRoleList()\" :columns=\"columns\" :controlColumn=\"true\"></right-toolbar>\r\n    </el-row>\r\n\r\n    <el-table :data=\"roleList\" @selection-change=\"handleSelectionChange\">\r\n      <el-table-column type=\"selection\" width=\"55px\" align=\"center\"></el-table-column>\r\n      <el-table-column label=\"角色编号\" prop=\"id\" width=\"120px\" v-if=\"columns[0].visible\"></el-table-column>\r\n      <el-table-column label=\"角色名称\" prop=\"name\" width=\"150px\" v-if=\"columns[1].visible\"></el-table-column>\r\n      <el-table-column label=\"权限字符\" prop=\"key\" width=\"150px\" v-if=\"columns[2].visible\"></el-table-column>\r\n      <el-table-column label=\"显示顺序\" prop=\"sort\" width=\"120px\" v-if=\"columns[3].visible\"></el-table-column>\r\n      <el-table-column label=\"状态\" width=\"100px\" v-if=\"columns[4].visible\">\r\n        <template slot-scope=\"scope\">\r\n          <el-switch\r\n            v-model=\"scope.row.status\"\r\n            @change=\"updateRoleStatus(scope.row)\"\r\n            active-value=\"1\"\r\n            inactive-value=\"0\"></el-switch>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"创建时间\" prop=\"create_time\" width=\"180px\" v-if=\"columns[5].visible\"></el-table-column>\r\n      <el-table-column label=\"操作\" align=\"center\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button\r\n            size=\"mini\"\r\n            type=\"text\"\r\n            icon=\"el-icon-edit\"\r\n            v-hasPerm=\"['system:role:edit']\"\r\n            @click=\"handleUpdate(scope.row)\">\r\n            修改\r\n          </el-button>\r\n          <el-button\r\n            size=\"mini\"\r\n            type=\"text\"\r\n            v-hasPerm=\"['system:role:delete']\"\r\n            @click=\"handleDelete(scope.row)\"\r\n            icon=\"el-icon-delete\">\r\n            删除\r\n          </el-button>\r\n          <el-dropdown\r\n            szie=\"mini\"\r\n            type=\"text\"\r\n            icon=\"el-icon-edit\">\r\n            <span class=\"el-dropdown-link\">\r\n              <i class=\"el-icon-d-arrow-right\"></i>更多\r\n            </span>\r\n            <el-dropdown-menu slot=\"dropdown\">\r\n              <el-dropdown-item icon=\"el-icon-circle-check\">数据权限</el-dropdown-item>\r\n              <el-dropdown-item icon=\"el-icon-user\">分配用户</el-dropdown-item>\r\n            </el-dropdown-menu>\r\n          </el-dropdown>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <pagination\r\n      :total=\"total\"\r\n      :pageSizes=\"[10, 20, 30, 50]\"\r\n      :page.sync=\"queryParams.pageNum\"\r\n      :limit.sync=\"queryParams.pageSize\"\r\n      @pagination=\"getRoleList\"></pagination>\r\n    \r\n    <el-dialog \r\n      :title=\"title\" \r\n      :visible.sync=\"open\"\r\n      width=\"500px\">\r\n      <el-form label-width=\"100px\" :model=\"form\" ref=\"addRoleFormRef\" :rules=\"rules\">\r\n        <el-form-item label=\"角色名称\" prop=\"roleName\">\r\n          <el-input placeholder=\"请输入角色名称\" v-model=\"form.roleName\"/>\r\n        </el-form-item>\r\n        <el-form-item label=\"权限字符\" prop=\"roleKey\">\r\n          <el-input placeholder=\"请输入权限字符\" v-model=\"form.roleKey\"/>\r\n        </el-form-item>\r\n        <el-form-item label=\"角色顺序\" prop=\"roleSort\">\r\n          <el-input-number controls-position=\"right\" :min=\"0\" v-model=\"form.roleSort\"/>\r\n        </el-form-item>\r\n        <el-form-item label=\"状态\">\r\n          <el-radio-group v-model=\"form.status\">\r\n            <el-radio\r\n              v-for=\"dict in dict.type.sys_normal_disable\"\r\n              :key=\"dict.value\"\r\n              :label=\"dict.value\">\r\n              {{dict.label}}\r\n            </el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <el-form-item label=\"菜单权限\">\r\n          <el-checkbox v-model=\"menuExpand\" @change=\"handleCheckedTreeExpand($event, 'menu')\">展开/折叠</el-checkbox>\r\n          <el-checkbox v-model=\"menuNodeAll\" @change=\"handleCheckedTreeNodeAll($event, 'menu')\">全选/全不选</el-checkbox>\r\n          <el-checkbox v-model=\"menuCheckStrictly\" @change=\"handleCheckedTreeConnect($event, 'menu')\">父子联动</el-checkbox>\r\n          <el-tree \r\n            :data=\"menuOptions\"\r\n            show-checkbox\r\n            ref=\"menu\"\r\n            node-key=\"id\"\r\n            :check-strictly=\"!menuCheckStrictly\"\r\n            class=\"tree-border\"\r\n            :props=\"defaultProps\"\r\n            empty-text=\"加载中，请稍后\"></el-tree>\r\n        </el-form-item>\r\n        <el-form-item label=\"备注\" prop=\"remark\">\r\n          <el-input placeholder=\"请输入内容\" type=\"textarea\" v-model=\"form.remark\"/>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\">\r\n        <el-button type=\"primary\" @click=\"submitForm\">确定</el-button>\r\n        <el-button @click=\"cancel\">取消</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport { listRole, addRole, getRole, updateRole, deleteRole, updateRoleStatus } from \"../../../api/system/role\"\r\nimport { treeselect as menuTreeSelect} from \"../../../api/system/menu\"\r\nimport { getPermissionByRoleId } from \"../../../api/system/rolePermission\"\r\n\r\n\r\nexport default {\r\n  name: \"Role\",\r\n  data() {\r\n    return {\r\n      dateRange: [],\r\n      queryParams: {\r\n        roleName: undefined,\r\n        roleKey: undefined,\r\n        status: undefined,\r\n        pageNum: 1,\r\n        pageSize: 10\r\n      },\r\n      roleList: [],\r\n      total: 0,\r\n      title: '',\r\n      open: false,\r\n      form: {},\r\n      defaultProps: {\r\n        children: 'children',\r\n        label: 'name'\r\n      },\r\n      rules: {\r\n        roleName: [\r\n          { required: true, message: '角色名称不能为空', trigger: 'blur' }\r\n        ],\r\n        roleKey: [\r\n          { required: true, message: '权限字符不能为空', trigger: 'blur' }\r\n        ],\r\n        roleSort: [\r\n          { required: true, message: '角色顺序不能为空', trigger: 'blur' }\r\n        ]\r\n      },\r\n      menuOptions: [],\r\n      menuExpand: false,\r\n      menuNodeAll: false,\r\n      menuCheckStrictly: true,\r\n      selectedIds: [],\r\n      selectedNames: [],\r\n      single: true,\r\n      multiple: true,\r\n      showSearch: true,\r\n      columns: [\r\n        {key: 0, label: '角色编号', visible: true},\r\n        {key: 1, label: '角色名称', visible: true},\r\n        {key: 2, label: '权限字符', visible: true},\r\n        {key: 3, label: '显示顺序', visible: true},\r\n        {key: 4, label: '状态', visible: true},\r\n        {key: 5, label: '创建时间', visible: true}\r\n      ]\r\n    }\r\n  },\r\n  created() {\r\n    this.getRoleList()\r\n  },\r\n  methods: {\r\n    handleUpdate(row) {\r\n      this.reset();\r\n      let roleId = row.id || this.selectedIds\r\n      // 获取所有的菜单列表\r\n      this.getMenuTreeSelect()\r\n      getRole(roleId).then(res => {\r\n        this.$set(this.form, 'roleId', res.id)\r\n        this.$set(this.form, 'roleName', res.name)\r\n        this.$set(this.form, 'roleKey', res.key)\r\n        this.$set(this.form, 'roleSort', res.sort)\r\n        this.$set(this.form, 'remark', res.remark)\r\n        this.$set(this.form, 'status', Number(res.status))\r\n        this.open = true\r\n        // 获取当前角色已分配的菜单列表\r\n        getPermissionByRoleId(roleId).then(result => {\r\n          let checkedKeys = result\r\n          checkedKeys.forEach(v => {\r\n            this.$refs.menu.setChecked(v, true, false)\r\n          });\r\n        })\r\n      })\r\n    },\r\n    getRoleList() {\r\n      listRole(this.addDateRange(this.queryParams, this.dateRange)).then(response => {\r\n        this.roleList = response.list\r\n        this.total = response.total\r\n      })\r\n    },\r\n    handleQuery() {\r\n      this.queryParams.pageNum = 1\r\n      this.getRoleList();\r\n    },\r\n    resetQuery() {\r\n      this.dateRange = []\r\n      this.resetForm('queryForm')\r\n      this.handleQuery();\r\n    },\r\n    handleAdd() {\r\n      this.reset();\r\n      this.getMenuTreeSelect();\r\n      this.title = '添加角色'\r\n      this.open = true\r\n    },\r\n    handleDelete(row) {\r\n      if(row != undefined && row != null && row.id != null) {\r\n        this.selectedIds.push(row.id)\r\n      }\r\n      let roleIds = this.selectedIds\r\n      this.$modal.confirm('确定删除角色【' + this.selectedNames.join() + '】？').then(function() {\r\n        deleteRole(roleIds).then(() => {\r\n          \r\n        })\r\n      }).then(() => {\r\n          this.$modal.msgSuccess('删除成功')\r\n          this.selectedIds = []\r\n          this.getRoleList()\r\n      }) \r\n    },\r\n    cancel() {\r\n      this.reset();\r\n      this.open = false\r\n    },\r\n    submitForm() {\r\n      this.$refs.addRoleFormRef.validate(valid => {\r\n        if(valid) {\r\n          let menuIds = this.getMenuAllCheckedKeys()\r\n          if(menuIds != null && menuIds.length > 0) {\r\n            this.form.permIds = menuIds\r\n          }\r\n          if(this.form.roleId !== undefined) {\r\n            updateRole(this.form).then(() => {\r\n              this.$modal.msgSuccess('修改成功')\r\n              this.getRoleList();\r\n              this.open = false;\r\n            })\r\n          } else {\r\n            addRole(this.form).then(() => {\r\n              this.$modal.msgSuccess('新增成功')\r\n              this.getRoleList();\r\n              this.open = false;\r\n            })\r\n          }\r\n        }\r\n      })\r\n    },\r\n    getMenuAllCheckedKeys() {\r\n      let checkedKeys = this.$refs.menu.getCheckedKeys();\r\n      let halfCheckedKeys = this.$refs.menu.getHalfCheckedKeys();\r\n      checkedKeys.unshift.apply(checkedKeys, halfCheckedKeys)\r\n      return checkedKeys\r\n    },\r\n    reset() {\r\n      this.form = {\r\n        permIds: [],\r\n        status: 1,\r\n        roleSort: 0\r\n      }\r\n      this.resetForm('addRoleFormRef')\r\n    },\r\n    getMenuTreeSelect() {\r\n      menuTreeSelect().then(response => {\r\n        this.menuOptions = response\r\n      })\r\n    },\r\n    handleCheckedTreeExpand(val, type) {\r\n      if(type === 'menu') {\r\n        let treeList = this.menuOptions\r\n        for(let i=0;i<treeList.length;i++) {\r\n          this.$refs.menu.store.nodesMap[treeList[i].id].expanded = val\r\n        }\r\n        \r\n      }\r\n    },\r\n    handleCheckedTreeNodeAll(val, type) {\r\n      if(type === 'menu') {\r\n        this.$refs.menu.setCheckedNodes(val ? this.menuOptions : [])\r\n      }\r\n    },\r\n    handleCheckedTreeConnect(val, type) {\r\n      if(type === 'menu') {\r\n        this.menuCheckStrictly = val\r\n      }\r\n    },\r\n    handleSelectionChange(val) {\r\n      this.selectedIds = val.map(item => item.id)\r\n      this.selectedNames = val.map(item => item.name)\r\n      this.single = this.selectedIds.length !== 1\r\n      this.multiple = !this.selectedIds.length\r\n    },\r\n    updateRoleStatus(row) {\r\n      let data = {\r\n        'roleId' : row.id,\r\n        'status' : row.status\r\n      }\r\n      updateRoleStatus(data).then(() => {\r\n        this.$modal.msgSuccess('角色状态修改成功')\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n\r\n</style>"]}]}