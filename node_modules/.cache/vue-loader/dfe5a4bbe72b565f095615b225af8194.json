{"remainingRequest":"D:\\vue_workspace\\filemanage\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue_workspace\\filemanage\\src\\views\\system\\role\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue_workspace\\filemanage\\src\\views\\system\\role\\index.vue","mtime":1673700685924},{"path":"D:\\vue_workspace\\filemanage\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue_workspace\\filemanage\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\vue_workspace\\filemanage\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue_workspace\\filemanage\\node_modules\\vue-loader\\lib\\index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQoNCmltcG9ydCB7IGxpc3RSb2xlLCBhZGRSb2xlLCBnZXRSb2xlLCB1cGRhdGVSb2xlLCBkZWxldGVSb2xlLCB1cGRhdGVSb2xlU3RhdHVzIH0gZnJvbSAiLi4vLi4vLi4vYXBpL3N5c3RlbS9yb2xlIg0KaW1wb3J0IHsgdHJlZXNlbGVjdCBhcyBtZW51VHJlZVNlbGVjdH0gZnJvbSAiLi4vLi4vLi4vYXBpL3N5c3RlbS9tZW51Ig0KaW1wb3J0IHsgZ2V0UGVybWlzc2lvbkJ5Um9sZUlkIH0gZnJvbSAiLi4vLi4vLi4vYXBpL3N5c3RlbS9yb2xlUGVybWlzc2lvbiINCg0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJSb2xlIiwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgZGF0ZVJhbmdlOiBbXSwNCiAgICAgIHF1ZXJ5UGFyYW1zOiB7DQogICAgICAgIHJvbGVOYW1lOiB1bmRlZmluZWQsDQogICAgICAgIHJvbGVLZXk6IHVuZGVmaW5lZCwNCiAgICAgICAgc3RhdHVzOiB1bmRlZmluZWQsDQogICAgICAgIHBhZ2VOdW06IDEsDQogICAgICAgIHBhZ2VTaXplOiAxMA0KICAgICAgfSwNCiAgICAgIHJvbGVMaXN0OiBbXSwNCiAgICAgIHRvdGFsOiAwLA0KICAgICAgdGl0bGU6ICcnLA0KICAgICAgb3BlbjogZmFsc2UsDQogICAgICBmb3JtOiB7fSwNCiAgICAgIGRlZmF1bHRQcm9wczogew0KICAgICAgICBjaGlsZHJlbjogJ2NoaWxkcmVuJywNCiAgICAgICAgbGFiZWw6ICduYW1lJw0KICAgICAgfSwNCiAgICAgIHJ1bGVzOiB7DQogICAgICAgIHJvbGVOYW1lOiBbDQogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+inkuiJsuWQjeensOS4jeiDveS4uuepuicsIHRyaWdnZXI6ICdibHVyJyB9DQogICAgICAgIF0sDQogICAgICAgIHJvbGVLZXk6IFsNCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn5p2D6ZmQ5a2X56ym5LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2JsdXInIH0NCiAgICAgICAgXSwNCiAgICAgICAgcm9sZVNvcnQ6IFsNCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6KeS6Imy6aG65bqP5LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2JsdXInIH0NCiAgICAgICAgXQ0KICAgICAgfSwNCiAgICAgIG1lbnVPcHRpb25zOiBbXSwNCiAgICAgIG1lbnVFeHBhbmQ6IGZhbHNlLA0KICAgICAgbWVudU5vZGVBbGw6IGZhbHNlLA0KICAgICAgbWVudUNoZWNrU3RyaWN0bHk6IHRydWUsDQogICAgICBzZWxlY3RlZElkczogW10sDQogICAgICBzZWxlY3RlZE5hbWVzOiBbXSwNCiAgICAgIHNpbmdsZTogdHJ1ZSwNCiAgICAgIG11bHRpcGxlOiB0cnVlLA0KICAgICAgc2hvd1NlYXJjaDogdHJ1ZSwNCiAgICAgIGNvbHVtbnM6IFsNCiAgICAgICAge2tleTogMCwgbGFiZWw6ICfop5LoibLnvJblj7cnLCB2aXNpYmxlOiB0cnVlfSwNCiAgICAgICAge2tleTogMSwgbGFiZWw6ICfop5LoibLlkI3np7AnLCB2aXNpYmxlOiB0cnVlfSwNCiAgICAgICAge2tleTogMiwgbGFiZWw6ICfmnYPpmZDlrZfnrKYnLCB2aXNpYmxlOiB0cnVlfSwNCiAgICAgICAge2tleTogMywgbGFiZWw6ICfmmL7npLrpobrluo8nLCB2aXNpYmxlOiB0cnVlfSwNCiAgICAgICAge2tleTogNCwgbGFiZWw6ICfnirbmgIEnLCB2aXNpYmxlOiB0cnVlfSwNCiAgICAgICAge2tleTogNSwgbGFiZWw6ICfliJvlu7rml7bpl7QnLCB2aXNpYmxlOiB0cnVlfQ0KICAgICAgXQ0KICAgIH0NCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICB0aGlzLmdldFJvbGVMaXN0KCkNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGhhbmRsZVVwZGF0ZShyb3cpIHsNCiAgICAgIHRoaXMucmVzZXQoKTsNCiAgICAgIGxldCByb2xlSWQgPSByb3cuaWQgfHwgdGhpcy5zZWxlY3RlZElkcw0KICAgICAgLy8g6I635Y+W5omA5pyJ55qE6I+c5Y2V5YiX6KGoDQogICAgICB0aGlzLmdldE1lbnVUcmVlU2VsZWN0KCkNCiAgICAgIGdldFJvbGUocm9sZUlkKS50aGVuKHJlcyA9PiB7DQogICAgICAgIHRoaXMuJHNldCh0aGlzLmZvcm0sICdyb2xlSWQnLCByZXMuaWQpDQogICAgICAgIHRoaXMuJHNldCh0aGlzLmZvcm0sICdyb2xlTmFtZScsIHJlcy5uYW1lKQ0KICAgICAgICB0aGlzLiRzZXQodGhpcy5mb3JtLCAncm9sZUtleScsIHJlcy5rZXkpDQogICAgICAgIHRoaXMuJHNldCh0aGlzLmZvcm0sICdyb2xlU29ydCcsIHJlcy5zb3J0KQ0KICAgICAgICB0aGlzLiRzZXQodGhpcy5mb3JtLCAncmVtYXJrJywgcmVzLnJlbWFyaykNCiAgICAgICAgdGhpcy4kc2V0KHRoaXMuZm9ybSwgJ3N0YXR1cycsIE51bWJlcihyZXMuc3RhdHVzKSkNCiAgICAgICAgdGhpcy5vcGVuID0gdHJ1ZQ0KICAgICAgICAvLyDojrflj5blvZPliY3op5LoibLlt7LliIbphY3nmoToj5zljZXliJfooagNCiAgICAgICAgZ2V0UGVybWlzc2lvbkJ5Um9sZUlkKHJvbGVJZCkudGhlbihyZXN1bHQgPT4gew0KICAgICAgICAgIGxldCBjaGVja2VkS2V5cyA9IHJlc3VsdA0KICAgICAgICAgIGNoZWNrZWRLZXlzLmZvckVhY2godiA9PiB7DQogICAgICAgICAgICB0aGlzLiRyZWZzLm1lbnUuc2V0Q2hlY2tlZCh2LCB0cnVlLCBmYWxzZSkNCiAgICAgICAgICB9KTsNCiAgICAgICAgfSkNCiAgICAgIH0pDQogICAgfSwNCiAgICBnZXRSb2xlTGlzdCgpIHsNCiAgICAgIGxpc3RSb2xlKHRoaXMuYWRkRGF0ZVJhbmdlKHRoaXMucXVlcnlQYXJhbXMsIHRoaXMuZGF0ZVJhbmdlKSkudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgIHRoaXMucm9sZUxpc3QgPSByZXNwb25zZS5saXN0DQogICAgICAgIHRoaXMudG90YWwgPSByZXNwb25zZS50b3RhbA0KICAgICAgfSkNCiAgICB9LA0KICAgIGhhbmRsZVF1ZXJ5KCkgew0KICAgICAgdGhpcy5xdWVyeVBhcmFtcy5wYWdlTnVtID0gMQ0KICAgICAgdGhpcy5nZXRSb2xlTGlzdCgpOw0KICAgIH0sDQogICAgcmVzZXRRdWVyeSgpIHsNCiAgICAgIHRoaXMuZGF0ZVJhbmdlID0gW10NCiAgICAgIHRoaXMucmVzZXRGb3JtKCdxdWVyeUZvcm0nKQ0KICAgICAgdGhpcy5oYW5kbGVRdWVyeSgpOw0KICAgIH0sDQogICAgaGFuZGxlQWRkKCkgew0KICAgICAgdGhpcy5yZXNldCgpOw0KICAgICAgdGhpcy5nZXRNZW51VHJlZVNlbGVjdCgpOw0KICAgICAgdGhpcy50aXRsZSA9ICfmt7vliqDop5LoibInDQogICAgICB0aGlzLm9wZW4gPSB0cnVlDQogICAgfSwNCiAgICBoYW5kbGVEZWxldGUocm93KSB7DQogICAgICBpZihyb3cgIT0gdW5kZWZpbmVkICYmIHJvdyAhPSBudWxsICYmIHJvdy5pZCAhPSBudWxsKSB7DQogICAgICAgIHRoaXMuc2VsZWN0ZWRJZHMucHVzaChyb3cuaWQpDQogICAgICB9DQogICAgICBsZXQgcm9sZUlkcyA9IHRoaXMuc2VsZWN0ZWRJZHMNCiAgICAgIHRoaXMuJG1vZGFsLmNvbmZpcm0oJ+ehruWumuWIoOmZpOinkuiJsuOAkCcgKyB0aGlzLnNlbGVjdGVkTmFtZXMuam9pbigpICsgJ+OAke+8nycpLnRoZW4oZnVuY3Rpb24oKSB7DQogICAgICAgIGRlbGV0ZVJvbGUocm9sZUlkcykudGhlbigoKSA9PiB7DQogICAgICAgICAgDQogICAgICAgIH0pDQogICAgICB9KS50aGVuKCgpID0+IHsNCiAgICAgICAgICB0aGlzLiRtb2RhbC5tc2dTdWNjZXNzKCfliKDpmaTmiJDlip8nKQ0KICAgICAgICAgIHRoaXMuc2VsZWN0ZWRJZHMgPSBbXQ0KICAgICAgICAgIHRoaXMuZ2V0Um9sZUxpc3QoKQ0KICAgICAgfSkgDQogICAgfSwNCiAgICBjYW5jZWwoKSB7DQogICAgICB0aGlzLnJlc2V0KCk7DQogICAgICB0aGlzLm9wZW4gPSBmYWxzZQ0KICAgIH0sDQogICAgc3VibWl0Rm9ybSgpIHsNCiAgICAgIHRoaXMuJHJlZnMuYWRkUm9sZUZvcm1SZWYudmFsaWRhdGUodmFsaWQgPT4gew0KICAgICAgICBpZih2YWxpZCkgew0KICAgICAgICAgIGxldCBtZW51SWRzID0gdGhpcy5nZXRNZW51QWxsQ2hlY2tlZEtleXMoKQ0KICAgICAgICAgIGlmKG1lbnVJZHMgIT0gbnVsbCAmJiBtZW51SWRzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIHRoaXMuZm9ybS5wZXJtSWRzID0gbWVudUlkcw0KICAgICAgICAgIH0NCiAgICAgICAgICBpZih0aGlzLmZvcm0ucm9sZUlkICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIHVwZGF0ZVJvbGUodGhpcy5mb3JtKS50aGVuKCgpID0+IHsNCiAgICAgICAgICAgICAgdGhpcy4kbW9kYWwubXNnU3VjY2Vzcygn5L+u5pS55oiQ5YqfJykNCiAgICAgICAgICAgICAgdGhpcy5nZXRSb2xlTGlzdCgpOw0KICAgICAgICAgICAgICB0aGlzLm9wZW4gPSBmYWxzZTsNCiAgICAgICAgICAgIH0pDQogICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGFkZFJvbGUodGhpcy5mb3JtKS50aGVuKCgpID0+IHsNCiAgICAgICAgICAgICAgdGhpcy4kbW9kYWwubXNnU3VjY2Vzcygn5paw5aKe5oiQ5YqfJykNCiAgICAgICAgICAgICAgdGhpcy5nZXRSb2xlTGlzdCgpOw0KICAgICAgICAgICAgICB0aGlzLm9wZW4gPSBmYWxzZTsNCiAgICAgICAgICAgIH0pDQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9KQ0KICAgIH0sDQogICAgZ2V0TWVudUFsbENoZWNrZWRLZXlzKCkgew0KICAgICAgbGV0IGNoZWNrZWRLZXlzID0gdGhpcy4kcmVmcy5tZW51LmdldENoZWNrZWRLZXlzKCk7DQogICAgICBsZXQgaGFsZkNoZWNrZWRLZXlzID0gdGhpcy4kcmVmcy5tZW51LmdldEhhbGZDaGVja2VkS2V5cygpOw0KICAgICAgY2hlY2tlZEtleXMudW5zaGlmdC5hcHBseShjaGVja2VkS2V5cywgaGFsZkNoZWNrZWRLZXlzKQ0KICAgICAgcmV0dXJuIGNoZWNrZWRLZXlzDQogICAgfSwNCiAgICByZXNldCgpIHsNCiAgICAgIHRoaXMuZm9ybSA9IHsNCiAgICAgICAgcGVybUlkczogW10sDQogICAgICAgIHN0YXR1czogMSwNCiAgICAgICAgcm9sZVNvcnQ6IDANCiAgICAgIH0NCiAgICAgIHRoaXMucmVzZXRGb3JtKCdhZGRSb2xlRm9ybVJlZicpDQogICAgfSwNCiAgICBnZXRNZW51VHJlZVNlbGVjdCgpIHsNCiAgICAgIG1lbnVUcmVlU2VsZWN0KCkudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgIHRoaXMubWVudU9wdGlvbnMgPSByZXNwb25zZQ0KICAgICAgfSkNCiAgICB9LA0KICAgIGhhbmRsZUNoZWNrZWRUcmVlRXhwYW5kKHZhbCwgdHlwZSkgew0KICAgICAgaWYodHlwZSA9PT0gJ21lbnUnKSB7DQogICAgICAgIGxldCB0cmVlTGlzdCA9IHRoaXMubWVudU9wdGlvbnMNCiAgICAgICAgZm9yKGxldCBpPTA7aTx0cmVlTGlzdC5sZW5ndGg7aSsrKSB7DQogICAgICAgICAgdGhpcy4kcmVmcy5tZW51LnN0b3JlLm5vZGVzTWFwW3RyZWVMaXN0W2ldLmlkXS5leHBhbmRlZCA9IHZhbA0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgfQ0KICAgIH0sDQogICAgaGFuZGxlQ2hlY2tlZFRyZWVOb2RlQWxsKHZhbCwgdHlwZSkgew0KICAgICAgaWYodHlwZSA9PT0gJ21lbnUnKSB7DQogICAgICAgIHRoaXMuJHJlZnMubWVudS5zZXRDaGVja2VkTm9kZXModmFsID8gdGhpcy5tZW51T3B0aW9ucyA6IFtdKQ0KICAgICAgfQ0KICAgIH0sDQogICAgaGFuZGxlQ2hlY2tlZFRyZWVDb25uZWN0KHZhbCwgdHlwZSkgew0KICAgICAgaWYodHlwZSA9PT0gJ21lbnUnKSB7DQogICAgICAgIHRoaXMubWVudUNoZWNrU3RyaWN0bHkgPSB2YWwNCiAgICAgIH0NCiAgICB9LA0KICAgIGhhbmRsZVNlbGVjdGlvbkNoYW5nZSh2YWwpIHsNCiAgICAgIHRoaXMuc2VsZWN0ZWRJZHMgPSB2YWwubWFwKGl0ZW0gPT4gaXRlbS5pZCkNCiAgICAgIHRoaXMuc2VsZWN0ZWROYW1lcyA9IHZhbC5tYXAoaXRlbSA9PiBpdGVtLm5hbWUpDQogICAgICB0aGlzLnNpbmdsZSA9IHRoaXMuc2VsZWN0ZWRJZHMubGVuZ3RoICE9PSAxDQogICAgICB0aGlzLm11bHRpcGxlID0gIXRoaXMuc2VsZWN0ZWRJZHMubGVuZ3RoDQogICAgfSwNCiAgICB1cGRhdGVSb2xlU3RhdHVzKHJvdykgew0KICAgICAgbGV0IGRhdGEgPSB7DQogICAgICAgICdyb2xlSWQnIDogcm93LmlkLA0KICAgICAgICAnc3RhdHVzJyA6IHJvdy5zdGF0dXMNCiAgICAgIH0NCiAgICAgIHVwZGF0ZVJvbGVTdGF0dXMoZGF0YSkudGhlbigoKSA9PiB7DQogICAgICAgIHRoaXMuJG1vZGFsLm1zZ1N1Y2Nlc3MoJ+inkuiJsueKtuaAgeS/ruaUueaIkOWKnycpDQogICAgICB9KQ0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;AA8LA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/system/role","sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n    <el-form :inline=\"true\" ref=\"queryForm\" :model=\"queryParams\" v-show=\"showSearch\">\r\n      <el-form-item label=\"角色名称\" prop=\"roleName\">\r\n        <el-input\r\n          v-model=\"queryParams.roleName\"\r\n          placeholder=\"请输入角色名称\"\r\n          size=\"small\"\r\n          style=\"width: 240px\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"权限字符\" prop=\"roleKey\">\r\n        <el-input\r\n          v-model=\"queryParams.roleKey\"\r\n          placeholder=\"请输入权限字符\"\r\n          size=\"small\"\r\n          style=\"width: 240px\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"状态\" prop=\"status\">\r\n        <el-select\r\n          v-model=\"queryParams.status\"\r\n          size=\"small\"\r\n          style=\"width: 240px\"></el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"创建时间\">\r\n        <el-date-picker\r\n          v-model=\"dateRange\"\r\n          type=\"daterange\"\r\n          range-separator=\"-\"\r\n          value-format=\"yyyy-MM-dd\"\r\n          start-placeholder=\"开始时间\"\r\n          end-placeholder=\"结束时间\"\r\n          size=\"small\"\r\n          style=\"width: 240px\"></el-date-picker>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button \r\n          type=\"primary\" \r\n          size=\"mini\" \r\n          icon=\"el-icon-search\"\r\n          @click=\"handleQuery\">搜索</el-button>\r\n        <el-button \r\n          icon=\"el-icon-refresh\"\r\n          size=\"mini\"\r\n          @click=\"resetQuery\">重置</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n    <el-row :gutter=\"10\">\r\n      <el-col :span=\"1.5\">\r\n        <el-button \r\n          type=\"primary\" \r\n          size=\"mini\" \r\n          icon=\"el-icon-plus\"\r\n          plain\r\n          v-hasPerm=\"['system:role:add']\"\r\n          @click=\"handleAdd\">新增</el-button>\r\n      </el-col>\r\n      <!--\r\n      <el-col :span=\"1.5\">\r\n        <el-button \r\n          type=\"success\" \r\n          size=\"mini\" \r\n          :disabled=\"single\"\r\n          icon=\"el-icon-edit\"\r\n          v-hasPerm=\"['system:role:edit']\"\r\n          @click=\"handleUpdate\"\r\n          plain>修改</el-button>\r\n      </el-col>\r\n      -->\r\n      <el-col :span=\"1.5\">\r\n        <el-button \r\n          type=\"danger\" \r\n          size=\"mini\"\r\n          :disabled=\"multiple\" \r\n          @click=\"handleDelete\"\r\n          icon=\"el-icon-delete\"\r\n          v-hasPerm=\"['system:role:delete']\"\r\n          plain>删除</el-button>\r\n      </el-col>\r\n      <right-toolbar :show-search.sync=\"showSearch\" @refresh=\"getRoleList()\" :columns=\"columns\" :controlColumn=\"true\"></right-toolbar>\r\n    </el-row>\r\n\r\n    <el-table :data=\"roleList\" @selection-change=\"handleSelectionChange\">\r\n      <el-table-column type=\"selection\" width=\"55px\" align=\"center\"></el-table-column>\r\n      <el-table-column label=\"角色编号\" prop=\"id\" width=\"120px\" v-if=\"columns[0].visible\"></el-table-column>\r\n      <el-table-column label=\"角色名称\" prop=\"name\" width=\"150px\" v-if=\"columns[1].visible\"></el-table-column>\r\n      <el-table-column label=\"权限字符\" prop=\"key\" width=\"150px\" v-if=\"columns[2].visible\"></el-table-column>\r\n      <el-table-column label=\"显示顺序\" prop=\"sort\" width=\"120px\" v-if=\"columns[3].visible\"></el-table-column>\r\n      <el-table-column label=\"状态\" width=\"100px\" v-if=\"columns[4].visible\">\r\n        <template slot-scope=\"scope\">\r\n          <el-switch\r\n            v-model=\"scope.row.status\"\r\n            @change=\"updateRoleStatus(scope.row)\"\r\n            active-value=\"1\"\r\n            inactive-value=\"0\"></el-switch>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"创建时间\" prop=\"create_time\" width=\"180px\" v-if=\"columns[5].visible\"></el-table-column>\r\n      <el-table-column label=\"操作\" align=\"center\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button\r\n            size=\"mini\"\r\n            type=\"text\"\r\n            icon=\"el-icon-edit\"\r\n            v-hasPerm=\"['system:role:edit']\"\r\n            @click=\"handleUpdate(scope.row)\">\r\n            修改\r\n          </el-button>\r\n          <el-button\r\n            size=\"mini\"\r\n            type=\"text\"\r\n            v-hasPerm=\"['system:role:delete']\"\r\n            @click=\"handleDelete(scope.row)\"\r\n            icon=\"el-icon-delete\">\r\n            删除\r\n          </el-button>\r\n          <el-dropdown\r\n            szie=\"mini\"\r\n            type=\"text\"\r\n            icon=\"el-icon-edit\">\r\n            <span class=\"el-dropdown-link\">\r\n              <i class=\"el-icon-d-arrow-right\"></i>更多\r\n            </span>\r\n            <el-dropdown-menu slot=\"dropdown\">\r\n              <el-dropdown-item icon=\"el-icon-circle-check\">数据权限</el-dropdown-item>\r\n              <el-dropdown-item icon=\"el-icon-user\">分配用户</el-dropdown-item>\r\n            </el-dropdown-menu>\r\n          </el-dropdown>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <pagination\r\n      :total=\"total\"\r\n      :pageSizes=\"[10, 20, 30, 50]\"\r\n      :page.sync=\"queryParams.pageNum\"\r\n      :limit.sync=\"queryParams.pageSize\"\r\n      @pagination=\"getRoleList\"></pagination>\r\n    \r\n    <el-dialog \r\n      :title=\"title\" \r\n      :visible.sync=\"open\"\r\n      width=\"500px\">\r\n      <el-form label-width=\"100px\" :model=\"form\" ref=\"addRoleFormRef\" :rules=\"rules\">\r\n        <el-form-item label=\"角色名称\" prop=\"roleName\">\r\n          <el-input placeholder=\"请输入角色名称\" v-model=\"form.roleName\"/>\r\n        </el-form-item>\r\n        <el-form-item label=\"权限字符\" prop=\"roleKey\">\r\n          <el-input placeholder=\"请输入权限字符\" v-model=\"form.roleKey\"/>\r\n        </el-form-item>\r\n        <el-form-item label=\"角色顺序\" prop=\"roleSort\">\r\n          <el-input-number controls-position=\"right\" :min=\"0\" v-model=\"form.roleSort\"/>\r\n        </el-form-item>\r\n        <el-form-item label=\"状态\">\r\n          <el-radio-group v-model=\"form.status\">\r\n            <el-radio\r\n              v-for=\"dict in dict.type.sys_normal_disable\"\r\n              :key=\"dict.value\"\r\n              :label=\"dict.value\">\r\n              {{dict.label}}\r\n            </el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <el-form-item label=\"菜单权限\">\r\n          <el-checkbox v-model=\"menuExpand\" @change=\"handleCheckedTreeExpand($event, 'menu')\">展开/折叠</el-checkbox>\r\n          <el-checkbox v-model=\"menuNodeAll\" @change=\"handleCheckedTreeNodeAll($event, 'menu')\">全选/全不选</el-checkbox>\r\n          <el-checkbox v-model=\"menuCheckStrictly\" @change=\"handleCheckedTreeConnect($event, 'menu')\">父子联动</el-checkbox>\r\n          <el-tree \r\n            :data=\"menuOptions\"\r\n            show-checkbox\r\n            ref=\"menu\"\r\n            node-key=\"id\"\r\n            :check-strictly=\"!menuCheckStrictly\"\r\n            class=\"tree-border\"\r\n            :props=\"defaultProps\"\r\n            empty-text=\"加载中，请稍后\"></el-tree>\r\n        </el-form-item>\r\n        <el-form-item label=\"备注\" prop=\"remark\">\r\n          <el-input placeholder=\"请输入内容\" type=\"textarea\" v-model=\"form.remark\"/>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\">\r\n        <el-button type=\"primary\" @click=\"submitForm\">确定</el-button>\r\n        <el-button @click=\"cancel\">取消</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport { listRole, addRole, getRole, updateRole, deleteRole, updateRoleStatus } from \"../../../api/system/role\"\r\nimport { treeselect as menuTreeSelect} from \"../../../api/system/menu\"\r\nimport { getPermissionByRoleId } from \"../../../api/system/rolePermission\"\r\n\r\n\r\nexport default {\r\n  name: \"Role\",\r\n  data() {\r\n    return {\r\n      dateRange: [],\r\n      queryParams: {\r\n        roleName: undefined,\r\n        roleKey: undefined,\r\n        status: undefined,\r\n        pageNum: 1,\r\n        pageSize: 10\r\n      },\r\n      roleList: [],\r\n      total: 0,\r\n      title: '',\r\n      open: false,\r\n      form: {},\r\n      defaultProps: {\r\n        children: 'children',\r\n        label: 'name'\r\n      },\r\n      rules: {\r\n        roleName: [\r\n          { required: true, message: '角色名称不能为空', trigger: 'blur' }\r\n        ],\r\n        roleKey: [\r\n          { required: true, message: '权限字符不能为空', trigger: 'blur' }\r\n        ],\r\n        roleSort: [\r\n          { required: true, message: '角色顺序不能为空', trigger: 'blur' }\r\n        ]\r\n      },\r\n      menuOptions: [],\r\n      menuExpand: false,\r\n      menuNodeAll: false,\r\n      menuCheckStrictly: true,\r\n      selectedIds: [],\r\n      selectedNames: [],\r\n      single: true,\r\n      multiple: true,\r\n      showSearch: true,\r\n      columns: [\r\n        {key: 0, label: '角色编号', visible: true},\r\n        {key: 1, label: '角色名称', visible: true},\r\n        {key: 2, label: '权限字符', visible: true},\r\n        {key: 3, label: '显示顺序', visible: true},\r\n        {key: 4, label: '状态', visible: true},\r\n        {key: 5, label: '创建时间', visible: true}\r\n      ]\r\n    }\r\n  },\r\n  created() {\r\n    this.getRoleList()\r\n  },\r\n  methods: {\r\n    handleUpdate(row) {\r\n      this.reset();\r\n      let roleId = row.id || this.selectedIds\r\n      // 获取所有的菜单列表\r\n      this.getMenuTreeSelect()\r\n      getRole(roleId).then(res => {\r\n        this.$set(this.form, 'roleId', res.id)\r\n        this.$set(this.form, 'roleName', res.name)\r\n        this.$set(this.form, 'roleKey', res.key)\r\n        this.$set(this.form, 'roleSort', res.sort)\r\n        this.$set(this.form, 'remark', res.remark)\r\n        this.$set(this.form, 'status', Number(res.status))\r\n        this.open = true\r\n        // 获取当前角色已分配的菜单列表\r\n        getPermissionByRoleId(roleId).then(result => {\r\n          let checkedKeys = result\r\n          checkedKeys.forEach(v => {\r\n            this.$refs.menu.setChecked(v, true, false)\r\n          });\r\n        })\r\n      })\r\n    },\r\n    getRoleList() {\r\n      listRole(this.addDateRange(this.queryParams, this.dateRange)).then(response => {\r\n        this.roleList = response.list\r\n        this.total = response.total\r\n      })\r\n    },\r\n    handleQuery() {\r\n      this.queryParams.pageNum = 1\r\n      this.getRoleList();\r\n    },\r\n    resetQuery() {\r\n      this.dateRange = []\r\n      this.resetForm('queryForm')\r\n      this.handleQuery();\r\n    },\r\n    handleAdd() {\r\n      this.reset();\r\n      this.getMenuTreeSelect();\r\n      this.title = '添加角色'\r\n      this.open = true\r\n    },\r\n    handleDelete(row) {\r\n      if(row != undefined && row != null && row.id != null) {\r\n        this.selectedIds.push(row.id)\r\n      }\r\n      let roleIds = this.selectedIds\r\n      this.$modal.confirm('确定删除角色【' + this.selectedNames.join() + '】？').then(function() {\r\n        deleteRole(roleIds).then(() => {\r\n          \r\n        })\r\n      }).then(() => {\r\n          this.$modal.msgSuccess('删除成功')\r\n          this.selectedIds = []\r\n          this.getRoleList()\r\n      }) \r\n    },\r\n    cancel() {\r\n      this.reset();\r\n      this.open = false\r\n    },\r\n    submitForm() {\r\n      this.$refs.addRoleFormRef.validate(valid => {\r\n        if(valid) {\r\n          let menuIds = this.getMenuAllCheckedKeys()\r\n          if(menuIds != null && menuIds.length > 0) {\r\n            this.form.permIds = menuIds\r\n          }\r\n          if(this.form.roleId !== undefined) {\r\n            updateRole(this.form).then(() => {\r\n              this.$modal.msgSuccess('修改成功')\r\n              this.getRoleList();\r\n              this.open = false;\r\n            })\r\n          } else {\r\n            addRole(this.form).then(() => {\r\n              this.$modal.msgSuccess('新增成功')\r\n              this.getRoleList();\r\n              this.open = false;\r\n            })\r\n          }\r\n        }\r\n      })\r\n    },\r\n    getMenuAllCheckedKeys() {\r\n      let checkedKeys = this.$refs.menu.getCheckedKeys();\r\n      let halfCheckedKeys = this.$refs.menu.getHalfCheckedKeys();\r\n      checkedKeys.unshift.apply(checkedKeys, halfCheckedKeys)\r\n      return checkedKeys\r\n    },\r\n    reset() {\r\n      this.form = {\r\n        permIds: [],\r\n        status: 1,\r\n        roleSort: 0\r\n      }\r\n      this.resetForm('addRoleFormRef')\r\n    },\r\n    getMenuTreeSelect() {\r\n      menuTreeSelect().then(response => {\r\n        this.menuOptions = response\r\n      })\r\n    },\r\n    handleCheckedTreeExpand(val, type) {\r\n      if(type === 'menu') {\r\n        let treeList = this.menuOptions\r\n        for(let i=0;i<treeList.length;i++) {\r\n          this.$refs.menu.store.nodesMap[treeList[i].id].expanded = val\r\n        }\r\n        \r\n      }\r\n    },\r\n    handleCheckedTreeNodeAll(val, type) {\r\n      if(type === 'menu') {\r\n        this.$refs.menu.setCheckedNodes(val ? this.menuOptions : [])\r\n      }\r\n    },\r\n    handleCheckedTreeConnect(val, type) {\r\n      if(type === 'menu') {\r\n        this.menuCheckStrictly = val\r\n      }\r\n    },\r\n    handleSelectionChange(val) {\r\n      this.selectedIds = val.map(item => item.id)\r\n      this.selectedNames = val.map(item => item.name)\r\n      this.single = this.selectedIds.length !== 1\r\n      this.multiple = !this.selectedIds.length\r\n    },\r\n    updateRoleStatus(row) {\r\n      let data = {\r\n        'roleId' : row.id,\r\n        'status' : row.status\r\n      }\r\n      updateRoleStatus(data).then(() => {\r\n        this.$modal.msgSuccess('角色状态修改成功')\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n\r\n</style>"]}]}