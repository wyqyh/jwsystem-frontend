{"remainingRequest":"D:\\vue_workspace\\jwsystem\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue_workspace\\jwsystem\\src\\views\\course\\add.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue_workspace\\jwsystem\\src\\views\\course\\add.vue","mtime":1679563062864},{"path":"D:\\vue_workspace\\jwsystem\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue_workspace\\jwsystem\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\vue_workspace\\jwsystem\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue_workspace\\jwsystem\\node_modules\\vue-loader\\lib\\index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQoNCmltcG9ydCB7IGdldENsYXNzQnlJZCB9IGZyb20gIi4uLy4uL2FwaS9iYXNpY2RhdGEvY2xhc3MiDQppbXBvcnQgeyBnZXRUZWFjaGVycyB9IGZyb20gIi4uLy4uL2FwaS9zeXN0ZW0vdXNlciINCmltcG9ydCB7IGFkZENvdXJzZSB9IGZyb20gIi4uLy4uL2FwaS9jb3Vyc2UvY291cnNlIg0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdBZGRDb3Vyc2UnLA0KICBwcm9wczogew0KICAgIHByYWN0aWNldHlwZXM6IHsNCiAgICAgIHR5cGU6IEFycmF5LA0KICAgICAgZGVmYXVsdCgpIHsNCiAgICAgICAgcmV0dXJuIFtdDQogICAgICB9DQogICAgfQ0KICB9LA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBvcGVuOiBmYWxzZSwNCiAgICAgIHRpdGxlOiAn5re75Yqg6K++56iLJywNCiAgICAgIGNsYXNzaW5mbzoge30sDQogICAgICBjb3Vyc2VpbmZvOiB7DQogICAgICAgIHVpZDogdGhpcy4kc3RvcmUuZ2V0dGVycy51aWQsDQogICAgICAgIGNsYXNzaWQ6IDAsDQogICAgICAgIHRlYWNoZXJpZHM6IFtdLA0KICAgICAgICBwcmltZTogW10NCg0KICAgICAgfSwNCiAgICAgIHJ1bGVzOiB7DQogICAgICAgIGNvdXJzZW5hbWU6IFsNCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36L6T5YWl6K++56iL5ZCN56ewJywgdHJpZ2dlcjogJ2JsdXInIH0NCiAgICAgICAgXSwNCiAgICAgICAgcHJhY3RpY2V0eXBlOiBbDQogICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fpgInmi6nlrp7ot7XnsbvliKsnLCB0cmlnZ2VyOiAnY2hhbmdlJywgdHlwZTogJ251bWJlcicgfQ0KICAgICAgICBdLA0KICAgICAgICBwcmltZTogWw0KICAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36YCJ5oup5Li7L+i+heiusicsIHRyaWdnZXI6ICdibHVyJyB9DQogICAgICAgIF0sDQogICAgICAgIHRlYWNoZXJpZHM6IFsNCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36YCJ5oup5Lu76K++5pWZ5ZGYJywgdHJpZ2dlcjogJ2JsdXInIH0NCiAgICAgICAgXSwNCiAgICAgICAgdGhlcm95aG91cjogWw0KICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fovpPlhaXnkIborrrlrabml7YnLCB0cmlnZ2VyOiAnYmx1cicgfQ0KICAgICAgICBdLA0KICAgICAgICBwcmFjdGljZWhvdXI6IFsNCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36L6T5YWl5a6e6Le15a2m5pe2JywgdHJpZ2dlcjogJ2JsdXInIH0NCiAgICAgICAgXSwNCiAgICAgICAgYmF0Y2hjb2VmZjogWw0KICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fovpPlhaXmibnmrKHns7vmlbAnLCB0cmlnZ2VyOiAnYmx1cicgfQ0KICAgICAgICBdDQogICAgICB9LA0KICAgICAgdGVhY2hlcnM6IFtdDQogICAgfQ0KICB9LA0KICBjcmVhdGVkKCkgew0KICAgIGdldFRlYWNoZXJzKCkudGhlbihyZXMgPT4gew0KICAgICAgdGhpcy50ZWFjaGVycyA9IHJlcw0KICAgIH0pDQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBvcGVuRGlhbG9nKGNsYXNzaWQpIHsNCiAgICAgIGlmKGNsYXNzaWQgPiAwKSB7DQogICAgICAgIGdldENsYXNzQnlJZChjbGFzc2lkKS50aGVuKHJlcyA9PiB7DQogICAgICAgICAgdGhpcy5jb3Vyc2VpbmZvLmNsYXNzaWQgPSBjbGFzc2lkDQogICAgICAgICAgdGhpcy5jbGFzc2luZm8gPSByZXMNCiAgICAgICAgICB0aGlzLm9wZW4gPSB0cnVlDQogICAgICAgIH0pDQogICAgICB9DQogICAgfSwNCiAgICBjbG9zZURpYWxvZygpIHsNCiAgICAgIHRoaXMuY2xhc3NpbmZvID0ge30NCiAgICAgIHRoaXMuY291cnNlaW5mbyA9IHt9DQogICAgICB0aGlzLm9wZW4gPSBmYWxzZQ0KICAgIH0sDQogICAgc3VibWl0Rm9ybSgpIHsNCiAgICAgIHRoaXMuJHJlZnMuY291cnNlSW5mb1JlZi52YWxpZGF0ZSh2YWxpZCA9PiB7DQogICAgICAgIGNvbnNvbGUubG9nKCIxMjMiKQ0KICAgICAgICBpZih2YWxpZCkgew0KICAgICAgICAgIGxldCBwcmltZXMgPSB0aGlzLmNvdXJzZWluZm8ucHJpbWUNCiAgICAgICAgICBpZihwcmltZXMgJiYgcHJpbWVzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIGlmKHByaW1lcy5sZW5ndGggPiAxKSB7IC8v5ZCM5pe26YCJ5Lit5LqG5Li76K6y5ZKM6L6F6K6yDQogICAgICAgICAgICAgIHRoaXMuY291cnNlaW5mby5wcmltZSA9IDINCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgIHRoaXMuY291cnNlaW5mby5wcmltZSA9IE51bWJlcihwcmltZXNbMF0pDQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgICAgIHRoaXMuY291cnNlaW5mby51aWQgPSBOdW1iZXIodGhpcy5jb3Vyc2VpbmZvLnVpZCkNCiAgICAgICAgICB0aGlzLmNvdXJzZWluZm8udGhlcm95aG91ciA9IE51bWJlcih0aGlzLmNvdXJzZWluZm8udGhlcm95aG91cikNCiAgICAgICAgICB0aGlzLmNvdXJzZWluZm8ucHJhY3RpY2Vob3VyID0gTnVtYmVyKHRoaXMuY291cnNlaW5mby5wcmFjdGljZWhvdXIpDQogICAgICAgICAgYWRkQ291cnNlKHRoaXMuY291cnNlaW5mbykudGhlbihyZXMgPT4gew0KICAgICAgICAgICAgbGV0IGNvZGUgPSByZXMuY29kZQ0KICAgICAgICAgICAgbGV0IG1zZyA9IHJlcy5tZXNzYWdlDQogICAgICAgICAgICBpZihjb2RlID09IDEwKSB7DQogICAgICAgICAgICAgIHRoaXMuJG1vZGFsLm1zZ0Vycm9yKG1zZykNCiAgICAgICAgICAgIH0gIGVsc2UgaWYoY29kZSA9PSAxMSkgew0KICAgICAgICAgICAgICB0aGlzLiRtb2RhbC5tc2dTdWNjZXNzKG1zZykNCiAgICAgICAgICAgICAgdGhpcy5jbG9zZURpYWxvZygpDQogICAgICAgICAgICB9DQogICAgICAgICAgfSkNCiAgICAgICAgfQ0KICAgICAgfSkNCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["add.vue"],"names":[],"mappings":";;AAwHA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"add.vue","sourceRoot":"src/views/course","sourcesContent":["<template>\r\n  <el-dialog\r\n    :title=\"title\"\r\n    :visible.sync=\"open\"\r\n    width=\"800px\"\r\n    @close=\"closeDialog\"\r\n  >\r\n    <el-form label-width=\"100px\" :model=\"courseinfo\" ref=\"courseInfoRef\" :rules=\"rules\">\r\n      <el-divider>期班信息</el-divider>\r\n      <el-row>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"期班号\">\r\n            <el-input v-model=\"classinfo.classno\" disabled/>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"专业名称\">\r\n            <el-input v-model=\"classinfo.majorname\" disabled/>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n      <el-row>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"开课学期\">\r\n            <el-input v-model=\"classinfo.term\" disabled/>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"培训层次\">\r\n            <el-input v-model=\"classinfo.trainlevel\" disabled/>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n      <el-row>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"学员人数\">\r\n            <el-input v-model=\"classinfo.stunum\" disabled/>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"任务类别\">\r\n            <el-input v-model=\"classinfo.tasktype\" disabled/>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n      <el-divider>课程信息</el-divider>\r\n      <el-row>\r\n        <el-col :span=\"10\">\r\n          <el-form-item label=\"课程名称\" prop=\"coursename\">\r\n            <el-input placeholder=\"请输入课程名称\" v-model=\"courseinfo.coursename\"/>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"14\">\r\n          <el-form-item label=\"任课教员\" prop=\"teacherids\">\r\n            <el-select v-model=\"courseinfo.teacherids\" multiple\r\n              placeholder=\"请选择任课教员\" style=\"width: 100%\">\r\n              <el-option\r\n                v-for=\"item in teachers\"\r\n                :key=\"item.id\"\r\n                :label=\"item.name\"\r\n                :value=\"item.id\">\r\n                <span style=\"float: left\">{{ item.name }}</span>\r\n                <span style=\"float: right; color: #8492a6; font-size: 13px\">{{ item.level2dept }}</span>\r\n              </el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n      <el-row>\r\n        <el-col :span=\"13\">\r\n          <el-form-item label=\"实践类别\" prop=\"practicetype\">\r\n            <el-select v-model=\"courseinfo.practicetype\" placeholder=\"请选择实践类别\" \r\n              clearable size=\"medium\"  style=\"width: 100%\">\r\n              <el-option\r\n                v-for=\"item in practicetypes\"\r\n                :key=\"item.id\"\r\n                :label=\"item.name\"\r\n                :value=\"item.id\">\r\n              </el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"11\">\r\n          <el-form-item label=\"主/辅讲\" prop=\"prime\">\r\n            <el-select v-model=\"courseinfo.prime\" multiple placeholder=\"请选择主/辅讲\" clearable size=\"medium\">\r\n              <el-option key=\"1\" label=\"主讲\" value=\"1\"/>\r\n              <el-option key=\"0\" label=\"辅讲\" value=\"0\"/>\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n      <el-row>\r\n        <el-col :span=\"8\">\r\n          <el-form-item label=\"理论学时\" prop=\"theroyhour\">\r\n            <el-input placeholder=\"请输入理论学时\" v-model=\"courseinfo.theroyhour\"/>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"8\">\r\n          <el-form-item label=\"实践学时\" prop=\"practicehour\">\r\n            <el-input placeholder=\"请输入实践学时\" v-model=\"courseinfo.practicehour\"/>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"8\">\r\n          <el-form-item label=\"批次系数\" prop=\"batchcoeff\">\r\n            <el-input placeholder=\"请输入批次系数\" v-model=\"courseinfo.batchcoeff\"/>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n      <el-row>\r\n        <el-col :span=\"24\" style=\"text-align: right\">\r\n          <el-button type=\"primary\" @click=\"submitForm\">确定</el-button>\r\n          <el-button @click=\"closeDialog\">取消</el-button>\r\n        </el-col>\r\n      </el-row>\r\n    </el-form>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script>\r\n\r\nimport { getClassById } from \"../../api/basicdata/class\"\r\nimport { getTeachers } from \"../../api/system/user\"\r\nimport { addCourse } from \"../../api/course/course\"\r\n\r\nexport default {\r\n  name: 'AddCourse',\r\n  props: {\r\n    practicetypes: {\r\n      type: Array,\r\n      default() {\r\n        return []\r\n      }\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      open: false,\r\n      title: '添加课程',\r\n      classinfo: {},\r\n      courseinfo: {\r\n        uid: this.$store.getters.uid,\r\n        classid: 0,\r\n        teacherids: [],\r\n        prime: []\r\n\r\n      },\r\n      rules: {\r\n        coursename: [\r\n          { required: true, message: '请输入课程名称', trigger: 'blur' }\r\n        ],\r\n        practicetype: [\r\n           { required: true, message: '请选择实践类别', trigger: 'change', type: 'number' }\r\n        ],\r\n        prime: [\r\n           { required: true, message: '请选择主/辅讲', trigger: 'blur' }\r\n        ],\r\n        teacherids: [\r\n          { required: true, message: '请选择任课教员', trigger: 'blur' }\r\n        ],\r\n        theroyhour: [\r\n          { required: true, message: '请输入理论学时', trigger: 'blur' }\r\n        ],\r\n        practicehour: [\r\n          { required: true, message: '请输入实践学时', trigger: 'blur' }\r\n        ],\r\n        batchcoeff: [\r\n          { required: true, message: '请输入批次系数', trigger: 'blur' }\r\n        ]\r\n      },\r\n      teachers: []\r\n    }\r\n  },\r\n  created() {\r\n    getTeachers().then(res => {\r\n      this.teachers = res\r\n    })\r\n  },\r\n  methods: {\r\n    openDialog(classid) {\r\n      if(classid > 0) {\r\n        getClassById(classid).then(res => {\r\n          this.courseinfo.classid = classid\r\n          this.classinfo = res\r\n          this.open = true\r\n        })\r\n      }\r\n    },\r\n    closeDialog() {\r\n      this.classinfo = {}\r\n      this.courseinfo = {}\r\n      this.open = false\r\n    },\r\n    submitForm() {\r\n      this.$refs.courseInfoRef.validate(valid => {\r\n        console.log(\"123\")\r\n        if(valid) {\r\n          let primes = this.courseinfo.prime\r\n          if(primes && primes.length > 0) {\r\n            if(primes.length > 1) { //同时选中了主讲和辅讲\r\n              this.courseinfo.prime = 2\r\n            } else {\r\n              this.courseinfo.prime = Number(primes[0])\r\n            }\r\n          }\r\n          this.courseinfo.uid = Number(this.courseinfo.uid)\r\n          this.courseinfo.theroyhour = Number(this.courseinfo.theroyhour)\r\n          this.courseinfo.practicehour = Number(this.courseinfo.practicehour)\r\n          addCourse(this.courseinfo).then(res => {\r\n            let code = res.code\r\n            let msg = res.message\r\n            if(code == 10) {\r\n              this.$modal.msgError(msg)\r\n            }  else if(code == 11) {\r\n              this.$modal.msgSuccess(msg)\r\n              this.closeDialog()\r\n            }\r\n          })\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n\r\n</style>"]}]}